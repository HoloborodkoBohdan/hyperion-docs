---
title: Level 3 - Components
description: Component-level view showing internal structure of FOP Backend
---

<Diagram
  lang="mermaid"
  chart="
graph TD;

    %% External Containers
    AdminFrontend[<a href='services/admin-frontend'>ğŸ–¥ï¸ Admin Frontend</a>]
    FOPFrontend[<a href='services/fop-frontend'>ğŸŒ FOP Frontend</a>]
    PostgresDB[(ğŸ—„ï¸ PostgreSQL Database)]
    Odoo[ğŸ’¼ Odoo ERP]
    TaxInspection[ğŸ›ï¸ Tax Inspection Registry]
    ReportEngine[ğŸ“„ Report Engine]
    FileStorage[ğŸ“¦ File Storage]

    %% FOP Backend Components
    subgraph FOPBackend[<a href='services/fop-backend'>âš™ï¸ FOP Backend - Python/Odoo Module</a>]

        subgraph ApplicationLayer[Application Layer - API & Controllers]
            APIController[API Controllers<br/>REST/JSONRPC endpoints]
            WebController[Web Controllers<br/>HTTP handlers]
        end

        subgraph ServiceLayer[Service Layer - Business Logic]
            EmployeeService[<a href='services/employee-service'>Employee Service</a><br/>Employee validation & KVED codes]
            ContractService[<a href='services/contract-service'>Contract Service</a><br/>Contract lifecycle & numbering]
            ReportService[Report Service<br/>PDF generation queue]
            FileService[File Service<br/>File storage & audit logs]
            PayrollService[Payroll Service<br/>Batch payment processing]
            TaxSyncService[Tax Sync Service<br/>Tax registry synchronization]
            BillingService[<a href='services/billing-service'>Billing Service</a><br/>Bill management & posting]
        end

        subgraph DataLayer[Data Layer - Models & Database Access]
            FOPModels[FOP Models<br/>fop_employee, fop_contract<br/>fop_bill, fop_company]
            HRModels[HR Models<br/>hr_employee, hr_contract]
            AttachmentModels[Attachment Models<br/>attachment, file_storage_log]
            ReportModels[Report Models<br/>report_queue]
        end
    end

    %% External to Application Layer
    AdminFrontend --> APIController
    AdminFrontend --> WebController
    FOPFrontend --> APIController

    %% Application to Service Layer
    APIController --> EmployeeService
    APIController --> ContractService
    APIController --> PayrollService
    APIController --> BillingService
    WebController --> EmployeeService
    WebController --> ContractService

    %% Service Layer Internal
    ContractService --> EmployeeService
    ContractService --> ReportService
    ReportService --> FileService
    PayrollService --> BillingService
    PayrollService --> TaxSyncService
    BillingService --> EmployeeService

    %% Service to Data Layer
    EmployeeService --> FOPModels
    EmployeeService --> HRModels
    ContractService --> FOPModels
    ContractService --> HRModels
    BillingService --> FOPModels
    PayrollService --> FOPModels
    FileService --> AttachmentModels
    ReportService --> ReportModels
    TaxSyncService --> FOPModels

    %% Data Layer to Database
    FOPModels --> PostgresDB
    HRModels --> PostgresDB
    AttachmentModels --> PostgresDB
    ReportModels --> PostgresDB

    %% Service to External Systems
    TaxSyncService <-->|2-way sync| TaxInspection
    ReportService --> ReportEngine
    FileService --> FileStorage
    PayrollService <-->|jsonrpc| Odoo
    BillingService <-->|jsonrpc| Odoo

    %% Styling
    classDef externalStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,color:#000
    classDef containerStyle fill:#fff9c4,stroke:#f57f17,stroke-width:3px,color:#000
    classDef layerStyle fill:#f5f5f5,stroke:#9e9e9e,stroke-width:2px,color:#000
    classDef appStyle fill:#bbdefb,stroke:#1976d2,stroke-width:2px,color:#000
    classDef serviceStyle fill:#c8e6c9,stroke:#388e3c,stroke-width:2px,color:#000
    classDef dataStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,color:#000
    classDef dbStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px,color:#000
    classDef infraStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px,color:#000

    class AdminFrontend,FOPFrontend externalStyle
    class FOPBackend containerStyle
    class ApplicationLayer,ServiceLayer,DataLayer layerStyle
    class APIController,WebController appStyle
    class EmployeeService,ContractService,ReportService,FileService,PayrollService,TaxSyncService,BillingService serviceStyle
    class FOPModels,HRModels,AttachmentModels,ReportModels dataStyle
    class PostgresDB dbStyle
    class Odoo,TaxInspection,ReportEngine,FileStorage infraStyle
"
/>
